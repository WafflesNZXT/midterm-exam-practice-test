<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra 2 Mid-Term Practice Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .graph-grid {
            background-image: 
                linear-gradient(to right, #e2e8f0 1px, transparent 1px),
                linear-gradient(to bottom, #e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .axis {
            stroke: #475569;
            stroke-width: 2;
        }
        .point {
            fill: #2563eb;
            cursor: pointer;
        }
        canvas#scratch-pad {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 40;
        }
        .drawing-active canvas#scratch-pad {
            pointer-events: auto;
            cursor: crosshair;
        }
        .tool-btn.active {
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            outline: 2px solid #2563eb;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen font-sans pb-20">

    <!-- Drawing Canvas Overlay -->
    <canvas id="scratch-pad"></canvas>

    <!-- Header & Progress -->
    <header class="sticky top-0 bg-white border-b shadow-sm z-50 px-4 py-3">
        <div class="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-xl font-bold text-slate-800">Algebra 2 Mid-Term Practice</h1>
                <p class="text-xs text-slate-500">Target: Complete any 45 of 60 questions</p>
            </div>
            
            <div class="flex items-center gap-4">
                <!-- Drawing Controls -->
                <div class="flex items-center bg-slate-100 rounded-lg p-1 gap-1 border border-slate-200">
                    <button onclick="setTool('cursor')" id="btn-cursor" class="tool-btn active p-1.5 rounded hover:bg-white transition-colors" title="Cursor (Select Answers)">
                        üñ±Ô∏è
                    </button>
                    <div class="h-6 w-px bg-slate-300 mx-0.5"></div>
                    <button onclick="setTool('pen')" id="btn-pen" class="tool-btn p-1.5 rounded hover:bg-white transition-colors" title="Pen">
                        üñãÔ∏è
                    </button>
                    <button onclick="setTool('marker')" id="btn-marker" class="tool-btn p-1.5 rounded hover:bg-white transition-colors" title="Marker">
                        üñçÔ∏è
                    </button>
                    <div class="h-6 w-px bg-slate-300 mx-1"></div>
                    <div class="flex gap-1">
                        <button onclick="setColor('#000000')" class="w-5 h-5 rounded-full bg-black border border-white" title="Black"></button>
                        <button onclick="setColor('#ef4444')" class="w-5 h-5 rounded-full bg-red-500 border border-white" title="Red"></button>
                        <button onclick="setColor('#3b82f6')" class="w-5 h-5 rounded-full bg-blue-500 border border-white" title="Blue"></button>
                        <button onclick="setColor('#22c55e')" class="w-5 h-5 rounded-full bg-green-500 border border-white" title="Green"></button>
                    </div>
                    <div class="h-6 w-px bg-slate-300 mx-1"></div>
                    <button onclick="clearScratchpad()" class="px-2 py-1 text-[10px] font-bold uppercase text-slate-500 hover:text-red-500 transition-colors">Clear</button>
                </div>

                <div class="flex items-center gap-4 border-l pl-4">
                    <div class="text-center">
                        <p class="text-[10px] font-semibold uppercase text-slate-400">Progress</p>
                        <p id="progress-text" class="text-lg font-bold text-blue-600">0/45</p>
                    </div>
                    <button onclick="toggleReference()" class="bg-amber-100 text-amber-800 px-3 py-1 rounded-md text-sm font-bold border border-amber-200">
                        üìú Cards
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 space-y-12" id="test-container"></main>

    <div id="reference-modal" class="fixed inset-0 bg-black/50 hidden z-[60] flex items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6 relative">
            <button onclick="toggleReference()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 text-2xl">‚úï</button>
            <h2 class="text-2xl font-bold mb-4">Unit Study Cards</h2>
            <div id="cards-content" class="space-y-6"></div>
        </div>
    </div>

    <script>
        const questions = [
            // MCQ (1-20)
            { id: 1, type: 'mcq', q: "Which of the following is an irrational number?", options: ["‚àö121", "0.333...", "‚àö20", "22/7"], correct: 2 },
            { id: 2, type: 'mcq', q: "Simplify: 3‚àö50 - 2‚àö8", options: ["‚àö42", "11‚àö2", "13‚àö2", "7‚àö2"], correct: 1 },
            { id: 3, type: 'mcq', q: "Solve for x: |2x - 5| = 13", options: ["{9}", "{9, -4}", "{-9, 4}", "No Solution"], correct: 1 },
            { id: 4, type: 'mcq', q: "What is the value of i^26?", options: ["i", "-i", "1", "-1"], correct: 3 },
            { id: 5, type: 'mcq', q: "Find the product: (3 - 2i)(4 + 5i)", options: ["12 - 10i", "22 + 7i", "2 + 7i", "22 - 7i"], correct: 1 },
            { id: 6, type: 'mcq', q: "Which property is shown by a(b + c) = ab + ac?", options: ["Associative", "Commutative", "Distributive", "Identity"], correct: 2 },
            { id: 7, type: 'mcq', q: "Simplify: (5x^3y^2)^2", options: ["10x^6y^4", "25x^5y^4", "25x^6y^4", "5x^6y^4"], correct: 2 },
            { id: 8, type: 'mcq', q: "Find the vertex of f(x) = 2(x - 3)^2 + 4.", options: ["(-3, 4)", "(3, 4)", "(3, -4)", "(2, 4)"], correct: 1 },
            { id: 9, type: 'mcq', q: "What is the discriminant of x^2 - 4x + 4 = 0?", options: ["0", "8", "16", "-16"], correct: 0 },
            { id: 10, type: 'mcq', q: "Factor completely: x^3 - 27", options: ["(x-3)(x^2+3x+9)", "(x-3)^3", "(x+3)(x^2-3x+9)", "(x-3)(x+3)^2"], correct: 0 },
            { id: 11, type: 'mcq', q: "Solve ‚àöx + 7 = 5.", options: ["18", "32", "2", "25"], correct: 0 },
            { id: 12, type: 'mcq', q: "If f(x) = x^2 + 1 and g(x) = x - 3, find (f ‚àò g)(x).", options: ["x^2 - 2", "x^2 - 6x + 10", "x^2 - 6x + 9", "x^2 - 3"], correct: 1 },
            { id: 13, type: 'mcq', q: "What is the inverse of f(x) = 3x - 6?", options: ["(x+6)/3", "x/3 + 6", "3x + 6", "-3x + 6"], correct: 0 },
            { id: 14, type: 'mcq', q: "Simplify: x^7 / x^-3", options: ["x^4", "x^10", "x^-4", "x^21"], correct: 1 },
            { id: 15, type: 'mcq', q: "Identify the parent function of y = -|x + 2| - 5.", options: ["Quadratic", "Square Root", "Absolute Value", "Linear"], correct: 2 },
            { id: 16, type: 'mcq', q: "Solve by factoring: x^2 - 5x - 14 = 0", options: ["{7, -2}", "{-7, 2}", "{14, -1}", "{-14, 1}"], correct: 0 },
            { id: 17, type: 'mcq', q: "Which describes the end behavior of f(x) = -2x^4 + 3x^2?", options: ["UP UP", "DOWN DOWN", "DOWN UP", "UP DOWN"], correct: 1 },
            { id: 18, type: 'mcq', q: "Simplify cubed root of -64x^6.", options: ["4x^2", "-4x^2", "8x^3", "-8x^2"], correct: 1 },
            { id: 19, type: 'mcq', q: "A system with no solution is called:", options: ["Consistent", "Independent", "Inconsistent", "Dependent"], correct: 2 },
            { id: 20, type: 'mcq', q: "Convert x^(3/4) to radical form.", options: ["Cubed root of x^4", "Fourth root of x^3", "4 * ‚àöx^3", "3 * ‚àöx^4"], correct: 1 },

            // Graphing (21-40)
            { id: 21, type: 'graph', q: "Graph y = (2/3)x - 4" },
            { id: 22, type: 'graph', q: "Graph the inequality y > -2x + 1" },
            { id: 23, type: 'graph', q: "Graph the system: y = x + 2 and y = -x + 4" },
            { id: 24, type: 'graph', q: "Graph the parent function f(x) = x^2" },
            { id: 25, type: 'graph', q: "Graph f(x) = (x + 3)^2 - 2" },
            { id: 26, type: 'graph', q: "Graph f(x) = |x - 1| + 4" },
            { id: 27, type: 'graph', q: "Graph y = ‚àöx + 4" },
            { id: 28, type: 'graph', q: "Graph y = cubed root of x - 2" },
            { id: 29, type: 'graph', q: "Graph f(x) = x (if x < 0) and f(x) = 2 (if x >= 0)" },
            { id: 30, type: 'graph', q: "Graph y = -(x - 2)^2 + 5" },
            { id: 31, type: 'graph', q: "Graph the solution to |x + 3| <= 2 on a 2D plane" },
            { id: 32, type: 'graph', q: "Graph f(x) = 2x^3" },
            { id: 33, type: 'graph', q: "Graph the inverse of the line y = 2x" },
            { id: 34, type: 'graph', q: "Graph y = ‚àöx - 3" },
            { id: 35, type: 'graph', q: "Graph a circle with center (0,0) and radius 3" },
            { id: 36, type: 'graph', q: "Graph f(x) = -|x|" },
            { id: 37, type: 'graph', q: "Graph y = 2^x (exponential sketch)" },
            { id: 38, type: 'graph', q: "Graph x = -3" },
            { id: 39, type: 'graph', q: "Graph y = 4" },
            { id: 40, type: 'graph', q: "Graph y = (x + 1)^3" },

            // Skills (41-60)
            { id: 41, type: 'text', q: "Solve and graph |x - 4| > 2 on a number line. (Enter notation, e.g., x < 2 or x > 6)", correct: "x < 2 or x > 6" },
            { id: 42, type: 'text', q: "Solve 3x + 5 <= 11 OR x - 1 > 5.", correct: "x <= 2 or x > 6" },
            { id: 43, type: 'text', q: "Simplify (2 + 3i) + (7 - 5i).", correct: "9-2i" },
            { id: 44, type: 'text', q: "Rationalize 5 / 2i.", correct: "-2.5i" },
            { id: 45, type: 'text', q: "Result of (x^2 - 5x + 6) / (x - 2) using synthetic division?", correct: "x-3" },
            { id: 46, type: 'text', q: "Factor 2x^2 + 7x + 3.", correct: "(2x+1)(x+3)" },
            { id: 47, type: 'text', q: "Solve x^2 - 6x + 10 = 0. (Enter as a+bi, a-bi)", correct: "3+i, 3-i" },
            { id: 48, type: 'text', q: "Solve ‚àö2x - 3 = ‚àöx + 5.", correct: "8" },
            { id: 49, type: 'text', q: "Solve x = ‚àöx + 6. Is there an extraneous solution?", correct: "3" },
            { id: 50, type: 'text', q: "Does f(g(x)) = x for f=4x and g=x/4? (Yes/No)", correct: "Yes" },
            { id: 51, type: 'text', q: "Find max height of h(t) = -16t^2 + 32t + 5.", correct: "21" },
            { id: 52, type: 'text', q: "Two consecutive integers sum to 45. Find them.", correct: "22, 23" },
            { id: 53, type: 'text', q: "Solve A = P + Prt for r.", correct: "(A-P)/(Pt)" },
            { id: 54, type: 'text', q: "If f(x)=2x and g(x)=3x^2, find g(f(2)).", correct: "48" },
            { id: 55, type: 'text', q: "Domain of y = ‚àöx - 5?", correct: "x >= 5" },
            { id: 56, type: 'text', q: "Name property: (a+b)+c = a+(b+c)", correct: "Associative" },
            { id: 57, type: 'text', q: "Value of i^100?", correct: "1" },
            { id: 58, type: 'text', q: "Factor x^3 + 2x^2 + 5x + 10 by grouping.", correct: "(x^2+5)(x+2)" },
            { id: 59, type: 'text', q: "Equation of line through (0,5) and (2,9)?", correct: "y=2x+5" },
            { id: 60, type: 'text', q: "Is every whole number an integer? (Yes/No)", correct: "Yes" }
        ];

        const cardData = [
            { unit: 1, title: "Card 1: Equations & Inequalities", content: "‚Ä¢ FLIP sign when √∑ by negative. ‚Ä¢ AND (Intersection) vs OR (Union). ‚Ä¢ |x|=neg is No Solution." },
            { unit: 2, title: "Card 2: Systems & Lines", content: "‚Ä¢ HOY (Horiz, 0 slope, Y=#). ‚Ä¢ VUX (Vert, Undef, X=#). ‚Ä¢ Perpendicular = Opp. Reciprocal." },
            { unit: 3, title: "Card 3: Transformations", content: "‚Ä¢ f(x-h) is RIGHT, f(x+h) is LEFT. ‚Ä¢ -f(x) reflects over x-axis. ‚Ä¢ f(x)+k is UP." },
            { unit: 4, title: "Card 4: Quadratics & i", content: "‚Ä¢ x = -b/2a (vertex). ‚Ä¢ D = b¬≤-4ac. ‚Ä¢ i¬π=i, i¬≤=-1, i¬≥=-i, i‚Å¥=1." },
            { unit: 5, title: "Card 5: Polynomials", content: "‚Ä¢ Synthetic Division: Use root. ‚Ä¢ Factor by grouping for 4 terms. ‚Ä¢ Sum/Diff of Cubes." },
            { unit: 6, title: "Card 6: Radicals & Inverses", content: "‚Ä¢ Switch X/Y for Inverse. ‚Ä¢ Power/Root conversion. ‚Ä¢ ALWAYS check extraneous roots!" }
        ];

        let state = { answers: {}, progress: 0 };
        
        // Drawing State
        let isDrawing = false;
        let brushColor = '#000000';
        let brushSize = 2;
        const canvas = document.getElementById('scratch-pad');
        const ctx = canvas.getContext('2d');

        function initDrawing() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            window.addEventListener('resize', () => {
                // Fix: Check if source width/height are > 0 before getting image data
                if (canvas.width > 0 && canvas.height > 0) {
                    try {
                        const temp = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        canvas.width = window.innerWidth;
                        canvas.height = window.innerHeight;
                        ctx.putImageData(temp, 0, 0);
                    } catch(e) {
                        canvas.width = window.innerWidth;
                        canvas.height = window.innerHeight;
                    }
                } else {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
            });

            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
        }

        function startDrawing(e) {
            if (!document.body.classList.contains('drawing-active')) return;
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(e.clientX, e.clientY);
        }

        function draw(e) {
            if (!isDrawing) return;
            ctx.strokeStyle = brushColor;
            ctx.lineWidth = brushSize;
            ctx.lineCap = 'round';
            ctx.lineTo(e.clientX, e.clientY);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function setTool(tool) {
            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
            
            if (tool === 'cursor') {
                document.body.classList.remove('drawing-active');
                document.getElementById('btn-cursor').classList.add('active');
            } else if (tool === 'pen') {
                brushSize = 2;
                document.body.classList.add('drawing-active');
                document.getElementById('btn-pen').classList.add('active');
            } else if (tool === 'marker') {
                brushSize = 8;
                document.body.classList.add('drawing-active');
                document.getElementById('btn-marker').classList.add('active');
            }
        }

        function setColor(color) {
            brushColor = color;
            // If currently on cursor, switch to pen automatically when picking a color
            if (!document.body.classList.contains('drawing-active')) {
                setTool('pen');
            }
        }

        function clearScratchpad() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function render() {
            const container = document.getElementById('test-container');
            container.innerHTML = '';

            const sections = [
                { title: "Part 1: Multiple Choice (1-20)", filter: q => q.id <= 20 },
                { title: "Part 2: Interactive Graphing (21-40)", filter: q => q.id > 20 && q.id <= 40 },
                { title: "Part 3: Skills & Applications (41-60)", filter: q => q.id > 40 }
            ];

            sections.forEach(sec => {
                const sectionEl = document.createElement('section');
                sectionEl.innerHTML = `<h2 class="text-2xl font-bold border-b-2 border-slate-200 pb-2 mb-6 text-slate-800">${sec.title}</h2>`;
                
                questions.filter(sec.filter).forEach(q => {
                    const card = document.createElement('div');
                    card.className = "bg-white p-6 rounded-xl shadow-sm mb-6 border border-slate-100 relative z-10";
                    card.innerHTML = `<p class="font-bold text-slate-700 mb-4">${q.id}. ${q.q}</p>`;

                    if (q.type === 'mcq') {
                        const opts = document.createElement('div');
                        opts.className = "grid grid-cols-1 md:grid-cols-2 gap-3";
                        q.options.forEach((opt, i) => {
                            const btn = document.createElement('button');
                            btn.className = `text-left px-4 py-3 border rounded-lg transition-all ${state.answers[q.id] === i ? 'bg-blue-600 text-white border-blue-600' : 'hover:bg-blue-50'}`;
                            btn.innerHTML = `<span class="font-mono mr-2 text-sm opacity-60">${['A','B','C','D'][i]})</span> ${opt}`;
                            btn.onclick = () => saveAnswer(q.id, i);
                            opts.appendChild(btn);
                        });
                        card.appendChild(opts);
                    } else if (q.type === 'graph') {
                        card.innerHTML += `
                            <div class="flex flex-col md:flex-row gap-6 items-center">
                                <div class="w-[280px] h-[280px] bg-white border border-slate-300 relative graph-grid rounded overflow-hidden" onclick="plotPoint(event, ${q.id})">
                                    <svg viewBox="0 0 200 200" class="w-full h-full" id="svg-${q.id}">
                                        <line x1="100" y1="0" x2="100" y2="200" class="axis" />
                                        <line x1="0" y1="100" x2="200" y2="100" class="axis" />
                                        <g id="points-${q.id}">${(state.answers[q.id] || []).map(p => `<circle cx="${p.x}" cy="${p.y}" r="4" class="point" />`).join('')}</g>
                                    </svg>
                                </div>
                                <div class="flex-1 space-y-3 w-full">
                                    <p class="text-xs text-slate-500 italic">Click grid to plot points. (At least 3 required)</p>
                                    <button onclick="clearGraph(${q.id})" class="text-red-500 text-xs font-bold uppercase tracking-wider">Reset Grid</button>
                                    <textarea placeholder="Show work or describe transformation here..." class="w-full p-3 border rounded-lg text-sm h-24 bg-slate-50 focus:bg-white transition-colors"></textarea>
                                </div>
                            </div>`;
                    } else {
                        card.innerHTML += `<input type="text" placeholder="Enter answer..." class="w-full p-3 border rounded-lg bg-slate-50" onchange="saveAnswer(${q.id}, this.value)" value="${state.answers[q.id] || ''}">`;
                    }
                    sectionEl.appendChild(card);
                });
                container.appendChild(sectionEl);
            });
            updateHeader();
        }

        function saveAnswer(id, val) {
            state.answers[id] = val;
            updateHeader();
            if (questions.find(q => q.id === id).type === 'mcq') render();
        }

        function plotPoint(e, id) {
            // Only plot points if drawing is NOT active
            if (document.body.classList.contains('drawing-active')) return;

            const svg = document.getElementById(`svg-${id}`);
            const rect = svg.getBoundingClientRect();
            const x = Math.round((e.clientX - rect.left) / (rect.width / 200) / 20) * 20;
            const y = Math.round((e.clientY - rect.top) / (rect.height / 200) / 20) * 20;
            
            if (!state.answers[id]) state.answers[id] = [];
            state.answers[id].push({x, y});
            
            const group = document.getElementById(`points-${id}`);
            const c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            c.setAttribute("cx", x); c.setAttribute("cy", y); c.setAttribute("r", 4);
            c.setAttribute("class", "point");
            group.appendChild(c);
            updateHeader();
        }

        function clearGraph(id) {
            delete state.answers[id];
            document.getElementById(`points-${id}`).innerHTML = '';
            updateHeader();
        }

        function updateHeader() {
            const count = Object.keys(state.answers).length;
            document.getElementById('progress-text').innerText = `${count}/45`;
            document.getElementById('progress-text').className = count >= 45 ? "text-lg font-bold text-green-600" : "text-lg font-bold text-blue-600";
        }

        function toggleReference() {
            const m = document.getElementById('reference-modal');
            m.classList.toggle('hidden');
            if (!m.classList.contains('hidden')) {
                const c = document.getElementById('cards-content');
                c.innerHTML = cardData.map(d => `
                    <div class="border-l-4 border-amber-400 bg-amber-50 p-4 rounded-r-lg">
                        <h3 class="font-bold text-amber-900">${d.title}</h3>
                        <p class="text-amber-800 text-sm mt-1 leading-relaxed">${d.content}</p>
                    </div>`).join('');
            }
        }

        window.onload = () => {
            render();
            initDrawing();
        };
    </script>
</body>
</html>
